<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PTA | Events</title>
  <link rel="icon" type="image/x-icon" href="../images/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="../stylesheets/navbar.css" />
  <link rel="stylesheet" type="text/css" href="../stylesheets/clubs-details.css" />
</head>
<body class="container">
  <div class="header">
    <div class="navbar">
      <a href="/home"><img src="/images/logo.png" class="logo" alt="Logo"></a>
      <ul class="tabs">
        <li class="home"><a href="/home">Home</a></li>
        <li class="athletes"><a href="/athletes">Athletes</a></li>
        <li class="clubs"><a href="/clubs">Clubs</a></li>
        <li class="events"><a href="/events">Events</a></li>
        <li class="membership"><a href="/membership">Membership</a></li>
        <li class="forum"><a href="/forum">Forum</a></li>
        <li class="notifications">
          <a href="/notifications">Notifications <span class="badge">3</span></a>
        </li>
        <li class="profile-pic">
          {{#if user.profilepic}}
            <a href="#" onclick="toggleDropdown()"><img src="{{user.profilepic}}" alt="Profile Picture" class="profile-picture"></a>
          {{else}}
            <a href="#" onclick="toggleDropdown()" class="profile-picture"><img src="/images/none.jpg" alt="Profile Picture" class="profile-picture"></a>
          {{/if}}
          <div id="dropdown" class="dropdown-content">
            <a href="/profile">Profile</a>
            <a href="/settings">Settings</a>
            <a href="/help-center">FAQs</a>
            <a href="/">Logout</a>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <div class="events-container">
      <img src="{{club.clubpic}}" alt="event Picture">
      <div class="clubname">
        <span class="name">{{club.clubname}}</span>
        {{#if (eq -club.registeredby user.id)}}
          <span><a href="/clubs-manage" class="manage-button" ><img src="/images/settings.png">Manage</a></span>
        {{/if}}
      </div>

      <div class="clubtabs">
        <ul>
          <li><a href="#">Details</a></li>
          <li><a href="#">Members</a></li>
          {{#if (eq user.club club.clubname)}}
            <li><a href="#">Announcements</a></li>
          {{/if}}
        </ul>
      </div><br>
      <div class="sides">
        <div class="leftside">
          <div class="intro">
            <h3>Details</h3>
            <p>{{club.clubaddress}}</p>
            <p>{{club.email}}</p>
            <p>{{club.phonenum}}</p>
          </div>
        </div>

        <div class="rightside">
					{{#if (eq club.registeredby user.id)}}
						<button class="invite-button" onclick="openModal()">+ Invite Members</button>
					{{/if}}
        </div>
      </div>
  </div>

	<div class="participants-container">
		<div class="participants-title">Participants</div>
		<table class="participants-table">
			<thead>
				<tr>
          <th>Picture</th>
					<th>Player</th>
					<th>Height (cm)</th>
					<th>Weight (kg)</th>
				</tr>
			</thead>
			<tbody>
				{{#each clubMembers}}
					<tr>
            <th><img src="{{this.portrait}}"></th>
						<td>{{this.name}}</td>
						<td>{{this.height}}</td>
						<td>{{this.weight}}</td>
					</tr>
				{{/each}}
			</tbody>
		</table>
	</div>


  
  <div class="announcements" hidden>
    <h2>Announcements</h2>
    <div class="makeannouncement">
      {{#if (eq club.registeredby user.id)}}
      <button class="newannounce" onclick="openannounceModal()">+ Announce</button>
      {{/if}}
    </div>
    {{#reverseEach announcements}}
      <div class="oneannouncement">
        <h2>{{title}}</h2>
        <p>{{subject}}</p>
        <p>{{body}}</p>
      </div>
    {{/reverseEach}}
  </div>

  <div id="announceModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" onclick="closeannounceModal()">&times;</span>
      <form action="/create-announcement" method="post" class="announceform">
        <input type="hidden" name="originalposter" value="{{user.username}}">
        <input type="hidden" name="profilepic" value="{{user.profilepic}}">
        <input type="hidden" name="clubid" value="{{club.id}}">
        
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" required>

        <label for="subject">Subject:</label>
        <input type="text" id="subject" name="subject" required>

        <label for="body">Body:</label>
        <textarea id="body" name="body" rows="4" required></textarea>

        <button type="submit" class="submit-announce">Post Announcement</button>
      </form>
    </div>
  </div>

	<div id="inviteModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <form action="/invite-user" method="post" class="inviteform">
        <input type="hidden" name="clubname" value="{{club.clubname}}">
        <input type="hidden" name="club_id" value="{{club.id}}">
        <label for="invited_user">Invite User:</label>
        <select name="invited_user" id="invited_user">
          {{#each allUsers}}
            <option value="{{id}}">{{firstname}}</option>
          {{/each}}
        </select>
        <button type="submit" class="submit-invite">Invite</button>
      </form>
    </div>
  </div>

  <script>
    function toggleDropdown() {
      document.getElementById("dropdown").classList.toggle("show");
    }

    window.onclick = function (event) {
      if (!event.target.matches('.profile-pic img')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        for (var i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
    // Get references to the elements
    const participantsTab = document.querySelector('.clubtabs ul li:nth-child(2) a');
    const detailsTab = document.querySelector('.clubtabs ul li:nth-child(1) a');
    const announcementsTab = document.querySelector('.clubtabs ul li:nth-child(3) a');
    const leftside = document.querySelector('.leftside');
    const rightside = document.querySelector('.rightside');
    const participantsContainer = document.querySelector('.participants-container');
    const announcements = document.querySelector('.announcements');

    // Hide participants container by default
    participantsContainer.style.display = 'none';

    // Function to show participants container and hide sides
    function showParticipants() {
      leftside.style.display = 'none';
      rightside.style.display = 'none';
      participantsContainer.style.display = 'block';
      announcements.style.display = 'none';
    }

    // Function to show sides and hide participants container
    function showDetails() {
      leftside.style.display = 'block';
      rightside.style.display = 'block';
      participantsContainer.style.display = 'none';
      announcements.style.display = 'none';
    }

    function showAnnouncements() {
      leftside.style.display = 'none';
      rightside.style.display = 'none';
      participantsContainer.style.display = 'none';
      announcements.style.display = 'block';
    }

    // Add event listener for the Participants tab
    participantsTab.addEventListener('click', function () {
      showParticipants();
    });

    // Add event listener for the Details tab
    detailsTab.addEventListener('click', function () {
        showDetails();
      });

    announcementsTab.addEventListener('click', function () {
        showAnnouncements();
      });
    }); 
      

    function openModal() {
      document.getElementById('inviteModal').style.display = 'block';
    }

    function closeModal() {
      document.getElementById('inviteModal').style.display = 'none';
    }

    function openannounceModal() {
      document.getElementById('announceModal').style.display = 'block';
    }

    function closeannounceModal() {
      document.getElementById('announceModal').style.display = 'none';
    }

    window.onclick = function(event) {
      if (event.target == document.getElementById('announceModal')) {
        closeModal();
      }
    }
  </script>
</body>
</html>
